<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Visitor Info</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container">
    <h1>Visitor Info</h1>
    <div class="info-item">IP: <span id="ip"></span></div>
    <div class="info-item">Location: <span id="location"></span></div>
    <div class="info-item">Visit count: <span id="count"></span></div>
    <div class="info-item">Visit times:</div>
    <ul id="times"></ul>
  </div>
  <script>
    async function loadInfo() {
      const res = await fetch('/info');
      const data = await res.json();
      document.getElementById('ip').textContent = data.ip;
      if (data.location && !data.location.error) {
        document.getElementById('location').textContent = `${data.location.country} ${data.location.regionName} ${data.location.city}`;
      } else {
        document.getElementById('location').textContent = 'Unknown';
      }
      document.getElementById('count').textContent = data.count;

      const timesList = document.getElementById('times');
      timesList.innerHTML = '';
      data.times.forEach(t => {
        const li = document.createElement('li');
        li.textContent = new Date(t).toLocaleString();
        timesList.appendChild(li);
      });
    }
    loadInfo();
  </script>
</body>
</html>
